<!DOCTYPE html>
<html>
<head>
    <title>р╕лр╕Щр╣Йр╕▓р╕Ир╕нр╣Бр╕кр╕Фр╕Зр╕Др╕┤р╕з</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
</head>
<body>
    <div class="display-container">
        <h1>ЁЯУ║ р╕лр╕бр╕▓р╕вр╣Ар╕ер╕Вр╕Чр╕╡р╣Ир╕Цр╕╣р╕Бр╣Ар╕гр╕╡р╕вр╕Б</h1>
        <div class="ticket-box">
            <h2 id="ticket">--</h2>
            <h3 id="counter">--</h3>
        </div>
        <audio id="beep" src="/static/audio/beep.mp3"></audio>
        <button id="enableVoice">ЁЯФК р╣Ар╕Ыр╕┤р╕Фр╣Ар╕кр╕╡р╕вр╕З</button>
    </div>
    <script>
        const socket = io();
        const synth = window.speechSynthesis;
        let voiceEnabled = false;

        function speak(text) {
            if (!synth || !voiceEnabled) return;
            const utter = new SpeechSynthesisUtterance(text);
            utter.lang = 'th-TH';
            synth.speak(utter);
        }

        document.getElementById('enableVoice').addEventListener('click', () => {
            const test = new SpeechSynthesisUtterance('р╣Ар╕гр╕┤р╣Ир╕бр╕гр╕░р╕Ър╕Ър╣Ар╕кр╕╡р╕вр╕З');
            test.lang = 'th-TH';
            synth.speak(test);
            voiceEnabled = true;
            document.getElementById('enableVoice').style.display = 'none';
        });

        socket.on('new_call', function(data) {
            document.getElementById('ticket').innerText = 'р╕лр╕бр╕▓р╕вр╣Ар╕ер╕В: ' + data.ticket;
            document.getElementById('counter').innerText = 'р╕Кр╣Ир╕нр╕Зр╕Ър╕гр╕┤р╕Бр╕▓р╕г: ' + data.counter;
            document.getElementById('beep').play();
            setTimeout(() => {
                speak(`р╣Ар╕Кр╕┤р╕Нр╕лр╕бр╕▓р╕вр╣Ар╕ер╕В ${data.ticket} р╕Чр╕╡р╣Ир╕Кр╣Ир╕нр╕Зр╕Ър╕гр╕┤р╕Бр╕▓р╕г ${data.counter}`);
            }, 1000);
        });
    </script>
</body>
</html>